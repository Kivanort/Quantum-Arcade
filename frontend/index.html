<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üé∞ Casino Royale - –ó–∞–≥—Ä—É–∑–∫–∞...</title>
    <link rel="stylesheet" href="css/loading.css">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #0f0f1a 0%, #1a1a2e 50%, #252542 100%);
            color: white;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            height: 100vh;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .loading-container {
            text-align: center;
            max-width: 400px;
            width: 90%;
        }

        .logo {
            font-size: 64px;
            margin-bottom: 30px;
            animation: pulse 2s infinite;
        }

        .game-title {
            font-size: 32px;
            font-weight: 800;
            margin-bottom: 20px;
            background: linear-gradient(135deg, #FFD700, #FF8C00, #FF4500);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .loading-bar-container {
            width: 100%;
            height: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            margin: 30px 0;
            overflow: hidden;
            position: relative;
        }

        .loading-bar {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #FF8C00, #FFD700);
            border-radius: 10px;
            transition: width 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .loading-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent 0%, 
                rgba(255, 255, 255, 0.4) 50%, 
                transparent 100%);
            animation: shimmer 2s infinite;
        }

        .loading-percentage {
            font-size: 24px;
            font-weight: 700;
            margin-top: 10px;
            color: #FFD700;
        }

        .loading-text {
            font-size: 16px;
            color: #b0b0c0;
            margin-top: 20px;
            min-height: 24px;
        }

        .hint {
            font-size: 14px;
            color: #808099;
            margin-top: 40px;
            opacity: 0.7;
        }

        .progress-steps {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
            position: relative;
        }

        .progress-steps::before {
            content: '';
            position: absolute;
            top: 15px;
            left: 10%;
            right: 10%;
            height: 2px;
            background: rgba(255, 255, 255, 0.1);
            z-index: 1;
        }

        .step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 2;
        }

        .step-icon {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 8px;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .step.active .step-icon {
            background: linear-gradient(135deg, #FF8C00, #FFD700);
            transform: scale(1.1);
        }

        .step.completed .step-icon {
            background: #32CD32;
        }

        .step-name {
            font-size: 12px;
            color: #b0b0c0;
        }

        .version {
            position: absolute;
            bottom: 20px;
            right: 20px;
            font-size: 12px;
            color: #808099;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .loading-container {
            animation: fadeIn 0.5s ease;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ */
        .logo { animation-delay: 0.1s; }
        .game-title { animation-delay: 0.2s; }
        .loading-bar-container { animation-delay: 0.3s; }
        .loading-text { animation-delay: 0.4s; }
        .progress-steps { animation-delay: 0.5s; }

        .loading-container > * {
            opacity: 0;
            animation: fadeIn 0.5s ease forwards;
        }

        /* –î–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ */
        @media (max-width: 480px) {
            .game-title {
                font-size: 24px;
            }
            
            .logo {
                font-size: 48px;
            }
            
            .progress-steps {
                margin-top: 20px;
            }
            
            .step-name {
                font-size: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="loading-container">
        <!-- –õ–æ–≥–æ—Ç–∏–ø -->
        <div class="logo">üé∞</div>
        
        <!-- –ù–∞–∑–≤–∞–Ω–∏–µ –∏–≥—Ä—ã -->
        <div class="game-title">CASINO ROYALE</div>
        
        <!-- –ü–æ–ª–æ—Å–∞ –∑–∞–≥—Ä—É–∑–∫–∏ -->
        <div class="loading-bar-container">
            <div class="loading-bar" id="loading-bar"></div>
        </div>
        
        <!-- –ü—Ä–æ—Ü–µ–Ω—Ç –∑–∞–≥—Ä—É–∑–∫–∏ -->
        <div class="loading-percentage" id="loading-percentage">0%</div>
        
        <!-- –¢–µ–∫—Å—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è -->
        <div class="loading-text" id="loading-text">–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã...</div>
        
        <!-- –ü–æ–¥—Å–∫–∞–∑–∫–∞ -->
        <div class="hint" id="hint">–ó–∞–≥—Ä—É–∂–∞–µ–º –ª—É—á—à–∏–µ –∞–Ω–∏–º–∞—Ü–∏–∏ –∏ —ç—Ñ—Ñ–µ–∫—Ç—ã...</div>
        
        <!-- –®–∞–≥–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ -->
        <div class="progress-steps">
            <div class="step active" id="step1">
                <div class="step-icon">1</div>
                <div class="step-name">–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è</div>
            </div>
            <div class="step" id="step2">
                <div class="step-icon">2</div>
                <div class="step-name">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö</div>
            </div>
            <div class="step" id="step3">
                <div class="step-icon">3</div>
                <div class="step-name">–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏–≥—Ä</div>
            </div>
            <div class="step" id="step4">
                <div class="step-icon">4</div>
                <div class="step-name">–ó–∞–ø—É—Å–∫</div>
            </div>
        </div>
        
        <!-- –í–µ—Ä—Å–∏—è -->
        <div class="version" id="version">v1.0.0</div>
    </div>

    <script>
        class LoadingScreen {
            constructor() {
                this.loadingBar = document.getElementById('loading-bar');
                this.loadingPercentage = document.getElementById('loading-percentage');
                this.loadingText = document.getElementById('loading-text');
                this.hint = document.getElementById('hint');
                this.version = document.getElementById('version');
                
                this.steps = {
                    step1: document.getElementById('step1'),
                    step2: document.getElementById('step2'),
                    step3: document.getElementById('step3'),
                    step4: document.getElementById('step4')
                };
                
                this.hints = [
                    "–ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É...",
                    "–ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...",
                    "–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∏–≥—Ä—ã...",
                    "–ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏–∏...",
                    "–ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ...",
                    "–ó–∞–≥—Ä—É–∂–∞–µ–º –≥—Ä–∞—Ñ–∏–∫—É...",
                    "–û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å...",
                    "–ü–æ—á—Ç–∏ –≥–æ—Ç–æ–≤–æ..."
                ];
                
                this.loadingPhases = [
                    { percent: 15, text: "–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App...", step: 1 },
                    { percent: 30, text: "–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...", step: 1 },
                    { percent: 45, text: "–ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞...", step: 2 },
                    { percent: 60, text: "–ó–∞–≥—Ä—É–∑–∫–∞ –∏–≥—Ä–æ–≤—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤...", step: 2 },
                    { percent: 75, text: "–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä...", step: 3 },
                    { percent: 85, text: "–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞...", step: 3 },
                    { percent: 95, text: "–§–∏–Ω–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞...", step: 4 },
                    { percent: 100, text: "–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!", step: 4 }
                ];
                
                this.currentPhase = 0;
                this.currentPercent = 0;
                this.hintInterval = null;
                this.loadingInterval = null;
                
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤–µ—Ä—Å–∏—é
                this.version.textContent = `v${this.getRandomVersion()}`;
            }
            
            getRandomVersion() {
                const versions = ['1.0.0', '1.1.2', '1.2.1', '1.3.0', '1.4.5'];
                return versions[Math.floor(Math.random() * versions.length)];
            }
            
            startLoading() {
                // –ù–∞—á–∏–Ω–∞–µ–º –º–µ–Ω—è—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫–∏
                this.startHintRotation();
                
                // –ù–∞—á–∏–Ω–∞–µ–º –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏
                this.startProgressSimulation();
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º Telegram Web App
                this.checkTelegramWebApp();
            }
            
            startHintRotation() {
                let hintIndex = 0;
                this.hintInterval = setInterval(() => {
                    this.hint.textContent = this.hints[hintIndex];
                    hintIndex = (hintIndex + 1) % this.hints.length;
                }, 2000);
            }
            
            startProgressSimulation() {
                this.loadingInterval = setInterval(() => {
                    if (this.currentPhase >= this.loadingPhases.length) {
                        this.completeLoading();
                        return;
                    }
                    
                    const phase = this.loadingPhases[this.currentPhase];
                    
                    // –ü–ª–∞–≤–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç
                    if (this.currentPercent < phase.percent) {
                        this.currentPercent += Math.random() * 3 + 1;
                        if (this.currentPercent > phase.percent) {
                            this.currentPercent = phase.percent;
                        }
                        
                        this.updateProgress(this.currentPercent, phase.text);
                        
                        // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π —à–∞–≥
                        this.updateActiveStep(phase.step);
                    } else {
                        // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–π —Ñ–∞–∑–µ
                        this.currentPhase++;
                    }
                }, 100);
            }
            
            updateProgress(percent, text) {
                // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç
                const displayPercent = Math.min(100, Math.floor(percent));
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–ª–æ—Å—É –∑–∞–≥—Ä—É–∑–∫–∏
                this.loadingBar.style.width = `${displayPercent}%`;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç
                this.loadingPercentage.textContent = `${displayPercent}%`;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç
                if (text) {
                    this.loadingText.textContent = text;
                }
                
                // –ú–µ–Ω—è–µ–º —Ü–≤–µ—Ç –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ 100%
                if (displayPercent >= 100) {
                    this.loadingBar.style.background = 'linear-gradient(90deg, #32CD32, #00FF7F)';
                    this.loadingPercentage.style.color = '#32CD32';
                }
            }
            
            updateActiveStep(stepNumber) {
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—Å–µ —à–∞–≥–∏
                Object.values(this.steps).forEach(step => {
                    step.classList.remove('active', 'completed');
                });
                
                // –û—Ç–º–µ—á–∞–µ–º –ø—Ä–æ–π–¥–µ–Ω–Ω—ã–µ —à–∞–≥–∏ –∫–∞–∫ completed
                for (let i = 1; i < stepNumber; i++) {
                    if (this.steps[`step${i}`]) {
                        this.steps[`step${i}`].classList.add('completed');
                    }
                }
                
                // –û—Ç–º–µ—á–∞–µ–º —Ç–µ–∫—É—â–∏–π —à–∞–≥ –∫–∞–∫ active
                if (this.steps[`step${stepNumber}`]) {
                    this.steps[`step${stepNumber}`].classList.add('active');
                }
            }
            
            checkTelegramWebApp() {
                setTimeout(() => {
                    if (window.Telegram && window.Telegram.WebApp) {
                        // Telegram Web App –¥–æ—Å—Ç—É–ø–µ–Ω
                        console.log('Telegram Web App –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                        
                        // –ú–µ–Ω—è–µ–º —Ç–µ–º—É –Ω–∞ —Ç–µ–º–Ω—É—é
                        window.Telegram.WebApp.setHeaderColor('#0f0f1a');
                        window.Telegram.WebApp.setBackgroundColor('#0f0f1a');
                        window.Telegram.WebApp.enableClosingConfirmation();
                        
                        // –†–∞—Å—à–∏—Ä—è–µ–º –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω
                        window.Telegram.WebApp.expand();
                        
                        // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                        const user = window.Telegram.WebApp.initDataUnsafe.user;
                        if (user) {
                            console.log('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:', user);
                            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –∏–≥—Ä–∞—Ö
                            localStorage.setItem('telegram_user_id', user.id);
                            localStorage.setItem('telegram_username', user.username || '');
                            localStorage.setItem('telegram_first_name', user.first_name || '');
                        }
                    } else {
                        console.log('Telegram Web App –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω. –†–µ–∂–∏–º –¥–µ–º–æ.');
                        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ
                        localStorage.setItem('telegram_user_id', 'demo_user');
                        localStorage.setItem('telegram_username', 'demo');
                        localStorage.setItem('telegram_first_name', '–î–µ–º–æ –ò–≥—Ä–æ–∫');
                    }
                }, 1000);
            }
            
            completeLoading() {
                // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã
                clearInterval(this.loadingInterval);
                clearInterval(this.hintInterval);
                
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º 100%
                this.updateProgress(100, "–ì–æ—Ç–æ–≤–æ! –ó–∞–ø—É—Å–∫–∞–µ–º –∏–≥—Ä—É...");
                this.updateActiveStep(4);
                
                // –î–æ–±–∞–≤–ª—è–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—É—é –∞–Ω–∏–º–∞—Ü–∏—é
                this.loadingText.style.color = '#32CD32';
                this.loadingText.style.fontWeight = '700';
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∞–Ω–∏–º–∞—Ü–∏—é –ø—É–ª—å—Å–∞—Ü–∏–∏
                this.loadingPercentage.style.animation = 'pulse 0.5s infinite';
                
                // –ñ–¥–µ–º 1.5 —Å–µ–∫—É–Ω–¥—ã –∏ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –∏–≥—Ä–µ
                setTimeout(() => {
                    this.transitionToGame();
                }, 1500);
            }
            
            transitionToGame() {
                // –î–æ–±–∞–≤–ª—è–µ–º –∞–Ω–∏–º–∞—Ü–∏—é –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏—è
                document.body.style.opacity = '0';
                document.body.style.transition = 'opacity 0.5s ease';
                
                // –ñ–¥–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏ –∏ –ø–µ—Ä–µ—Ö–æ–¥–∏–º
                setTimeout(() => {
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
                    const loadTime = Date.now();
                    localStorage.setItem('game_load_time', loadTime);
                    
                    // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –∏–≥—Ä–µ –ú–æ–Ω–æ
                    window.location.href = 'mono.html';
                }, 500);
            }
            
            // –ë—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (Shift + Click)
            enableQuickLoad() {
                document.addEventListener('keydown', (e) => {
                    if (e.shiftKey && e.code === 'KeyL') {
                        e.preventDefault();
                        this.completeLoading();
                    }
                });
                
                // –î–≤–æ–π–Ω–æ–π —Ç–∞–ø –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
                let tapCount = 0;
                let lastTap = 0;
                
                document.addEventListener('click', (e) => {
                    const currentTime = new Date().getTime();
                    const tapLength = currentTime - lastTap;
                    
                    if (tapLength < 300 && tapLength > 0) {
                        tapCount++;
                        if (tapCount >= 3) {
                            this.completeLoading();
                        }
                    } else {
                        tapCount = 1;
                    }
                    
                    lastTap = currentTime;
                });
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏ –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', () => {
            const loadingScreen = new LoadingScreen();
            loadingScreen.startLoading();
            loadingScreen.enableQuickLoad();
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º —Ñ–æ–Ω–æ–≤—É—é –º—É–∑—ã–∫—É (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
            try {
                const audio = new Audio('assets/sounds/loading.mp3');
                audio.volume = 0.3;
                audio.loop = true;
                // audio.play(); // –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –µ—Å–ª–∏ –µ—Å—Ç—å –º—É–∑—ã–∫–∞
            } catch (e) {
                console.log('–ê—É–¥–∏–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ');
            }
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∑–∞–≥—Ä—É–∑–∫–∏
            window.addEventListener('error', (e) => {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', e);
                loadingScreen.loadingText.textContent = "–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É.";
                loadingScreen.loadingText.style.color = '#DC143C';
            });
        });
    </script>
</body>
</html>
